
# Middleware in Laravel

In Laravel, middleware plays a critical role in filtering and processing HTTP requests entering your application. Middleware sits between the incoming request and the application logic, handling various tasks such as authentication, logging, CORS (Cross-Origin Resource Sharing), and input validation. Below are essential types of middleware used in Laravel:

---

### 1. **Authentication Middleware (auth)**
- Ensures the user is authenticated before accessing certain routes or resources.
- **Example**: Protect routes that require a logged-in user.
  
  **Command to create**: 
  ```bash
  php artisan make:middleware Authenticate
  ```

  **Usage in routes**:
  ```php
  Route::get('/dashboard', [DashboardController::class, 'index'])->middleware('auth');
  ```

---

### 2. **CSRF Protection (VerifyCsrfToken)**
- Protects the application from cross-site request forgery (CSRF) attacks.
- Automatically applied to POST, PUT, DELETE requests.
- Pre-configured in `$middleware` array in `app/Http/Kernel.php`.

---

### 3. **CORS Middleware (HandleCors)**
- Manages Cross-Origin Resource Sharing, allowing/blocking requests from different origins.
- **Configuration file**: `config/cors.php`.

---

### 4. **Rate Limiting (throttle)**
- Limits the number of requests to a specific route within a time frame.
  
  **Usage in routes**:
  ```php
  Route::middleware('throttle:60,1')->group(function () {
      Route::get('/api/resource', [ApiController::class, 'getResource']);
  });
  ```

---

### 5. **Redirect If Authenticated (RedirectIfAuthenticated)**
- Redirects already authenticated users away from login/registration pages.
- Automatically applied to routes like login, register, and password reset.

---

### 6. **Encrypt Cookies (EncryptCookies)**
- Automatically encrypts and decrypts cookies generated by the application for security.
- Applied globally.

---

### 7. **Maintenance Mode (CheckForMaintenanceMode)**
- Restricts access when the application is in maintenance mode, allowing only specific users (e.g., admins) based on IP.

---

### 8. **Force HTTPS (\App\Http\Middleware\ForceHttps)**
- Forces the application to use HTTPS for all incoming requests.
- Can be applied globally or to specific routes.

---

### 9. **Localization Middleware (SetLocale)**
- Sets the application locale based on user preferences or browser settings.

---

### 10. **Custom Middleware**
- Allows you to create specific middleware for tasks such as logging user activity or handling role-based access control.

  **Command to create**:
  ```bash
  php artisan make:middleware LogRequests
  ```

---

### 11. **EnsureEmailIsVerified**
- Ensures users have verified their email before accessing certain routes.

  **Usage in routes**:
  ```php
  Route::get('/profile', [ProfileController::class, 'index'])->middleware('verified');
  ```

---

### 12. **Check Role (CheckRole)**
- Ensures that the user has a specific role before accessing routes.
  
  **Custom implementation**:
  ```php
  Route::middleware('role:admin')->group(function () {
      Route::get('/admin/dashboard', [AdminController::class, 'index']);
  });
  ```

---

### 13. **Cache Headers Middleware**
- Adds cache control headers to HTTP responses to optimize performance by caching static resources.
  
---

### 14. **Trim Strings (TrimStrings)**
- Automatically trims whitespace from all input data received from forms.
  
---

### 15. **Convert Empty Strings to Null (ConvertEmptyStringsToNull)**
- Converts empty string form inputs to null values before storing them in the database.

---

### 16. **TrustProxies**
- Ensures correct IP handling when the application is behind a proxy (e.g., AWS ELB or Cloudflare).

---

### 17. **SubstituteBindings**
- Handles route model binding, automatically mapping URL parameters to models.

---

### 18. **Encrypt Request Payloads**
- Custom middleware that encrypts sensitive request payloads before processing them.

---

### 19. **Log Requests**
- Custom middleware to log every incoming request for auditing purposes.

---

### 20. **Handle Inertia Requests**
- Middleware specific to Inertia.js applications to manage requests between Vue.js frontend and Laravel backend.

---

### 21. **Set Cache TTL**
- Custom middleware to dynamically set Time to Live (TTL) for cached resources.

---

### 22. **Optimize Images**
- Automatically processes and optimizes image uploads (e.g., resizing and compressing).

---

### 23. **Throttle Submissions**
- Limits the frequency of form submissions or API calls within a time frame to prevent abuse.

---

### 24. **Prevent Back History**
- Prevents users from accessing protected pages via the browser’s back button after logging out.

---

### 25. **LogOut Inactive Users**
- Logs out users automatically after a period of inactivity.

---

### 26. **Force JSON Response**
- Forces JSON responses from API routes, regardless of the request’s Accept header.

---

### 27. **Redirect HTTP to HTTPS**
- Redirects all HTTP traffic to HTTPS for secure access.

---

### 28. **Log User Actions**
- Logs specific user actions such as viewing a page or making a purchase.

---

### 29. **User Agent Blocking**
- Blocks specific user agents (e.g., bots) from accessing the application.

---

### 30. **Language Detection Middleware**
- Detects the user’s preferred language and sets the application locale accordingly.

---

### 31. **Prevent Duplicate Submissions**
- Prevents duplicate form submissions by temporarily disabling submission.

---

### 32. **User Timezone Middleware**
- Sets the user’s timezone based on their profile or request.

---

### 33. **Password Expiry Check**
- Custom middleware that forces users to update their password after a certain expiry time.
